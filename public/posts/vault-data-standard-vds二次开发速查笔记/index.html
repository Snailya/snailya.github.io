<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Vault Data Standard (VDS)二次开发速查笔记 | Snailya虾啵啵</title><meta name=keywords content="Vault,VDS,DataStandard"><meta name=description content="一、什么是 Autodesk Vault Data Standard（VDS）？

常见误解纠正：
名称 Data Standard 并非指“数据校验（Validation）”，而是 “数据标准化（Standardization）” —— 它的核心使命是：
在用户输入源头，将自由、随意、不一致的数据，转化为结构化、规范、可被系统理解的属性值。

▸ 它解决什么问题？
在未启用 Data Standard 时，Vault 用户检入文件仅能填写极少数基础字段（如文件名、生命周期状态），大量业务属性（如 型号、流量、材质、明细写法）依赖后续手动补录，极易导致：

属性缺失、错填、单位混乱（1500rpm vs 1500 RPM）
同类文件规格描述格式不一（Q=10m³/h, H=20m vs 10×20）
CAD 与 Vault 属性不同步
→ 最终使得自动化、检索、BOM 生成等高级功能失效。

▸ 它如何工作？
当启用 Data Standard 后，在以下关键操作时，自动弹出一个标准化数据录入窗口（常称 Property Dialog）：

Vault Client 中：

新建/编辑 文件（对应 File.xaml）
新建/编辑 文件夹（对应 Folder.xaml）


Inventor / AutoCAD 中：

检入（Check In） 文件时
保存到 Vault 时



该窗口默认采用 左右双栏布局：

  
      
          区域
          内容
          控制方式
      
  
  
      
          左侧面板
          固定属性（Static Properties）由 XAML 手动定义的控件（如 <TextBox>、<ComboBox>）
          修改 File.xaml / Folder.xaml
      
      
          右侧面板
          动态属性 Grid（Dynamic Properties）自动列出该 Vault Category 下关联的所有 Attribute
          由 DynamicProperties.xml 控制显隐、顺序、别名
      
  


补充说明：除文件（File）与文件夹（Folder）外，以下对象也支持 Data Standard（较少用但存在）："><meta name=author content="Snailya"><link rel=canonical href=http://localhost:1313/posts/vault-data-standard-vds%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E9%80%9F%E6%9F%A5%E7%AC%94%E8%AE%B0/><meta name=google-site-verification content="_nlVQH6tLVYCE2QdNfIoFucl_5aGPyN1U8HOag0GDZg"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.ae3d277e69647c027e65dd7c785748f912a9be2d37da0061b9ff15a5d7fafb7b.css integrity="sha256-rj0nfmlkfAJ+Zd18eFdI+RKpvi032gBhuf8Vpdf6+3s=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/vault-data-standard-vds%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E9%80%9F%E6%9F%A5%E7%AC%94%E8%AE%B0/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-3LD1SQETXX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3LD1SQETXX")}</script><meta property="og:url" content="http://localhost:1313/posts/vault-data-standard-vds%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E9%80%9F%E6%9F%A5%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="Snailya虾啵啵"><meta property="og:title" content="Vault Data Standard (VDS)二次开发速查笔记"><meta property="og:description" content="一、什么是 Autodesk Vault Data Standard（VDS）？ 常见误解纠正：
名称 Data Standard 并非指“数据校验（Validation）”，而是 “数据标准化（Standardization）” —— 它的核心使命是：
在用户输入源头，将自由、随意、不一致的数据，转化为结构化、规范、可被系统理解的属性值。
▸ 它解决什么问题？ 在未启用 Data Standard 时，Vault 用户检入文件仅能填写极少数基础字段（如文件名、生命周期状态），大量业务属性（如 型号、流量、材质、明细写法）依赖后续手动补录，极易导致：
属性缺失、错填、单位混乱（1500rpm vs 1500 RPM） 同类文件规格描述格式不一（Q=10m³/h, H=20m vs 10×20） CAD 与 Vault 属性不同步
→ 最终使得自动化、检索、BOM 生成等高级功能失效。 ▸ 它如何工作？ 当启用 Data Standard 后，在以下关键操作时，自动弹出一个标准化数据录入窗口（常称 Property Dialog）：
Vault Client 中： 新建/编辑 文件（对应 File.xaml） 新建/编辑 文件夹（对应 Folder.xaml） Inventor / AutoCAD 中： 检入（Check In） 文件时 保存到 Vault 时 该窗口默认采用 左右双栏布局：
区域 内容 控制方式 左侧面板 固定属性（Static Properties）由 XAML 手动定义的控件（如 <TextBox>、<ComboBox>） 修改 File.xaml / Folder.xaml 右侧面板 动态属性 Grid（Dynamic Properties）自动列出该 Vault Category 下关联的所有 Attribute 由 DynamicProperties.xml 控制显隐、顺序、别名 补充说明：除文件（File）与文件夹（Folder）外，以下对象也支持 Data Standard（较少用但存在）："><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-16T14:48:40+08:00"><meta property="article:modified_time" content="2025-12-16T14:48:40+08:00"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Vault Data Standard (VDS)二次开发速查笔记"><meta name=twitter:description content="一、什么是 Autodesk Vault Data Standard（VDS）？

常见误解纠正：
名称 Data Standard 并非指“数据校验（Validation）”，而是 “数据标准化（Standardization）” —— 它的核心使命是：
在用户输入源头，将自由、随意、不一致的数据，转化为结构化、规范、可被系统理解的属性值。

▸ 它解决什么问题？
在未启用 Data Standard 时，Vault 用户检入文件仅能填写极少数基础字段（如文件名、生命周期状态），大量业务属性（如 型号、流量、材质、明细写法）依赖后续手动补录，极易导致：

属性缺失、错填、单位混乱（1500rpm vs 1500 RPM）
同类文件规格描述格式不一（Q=10m³/h, H=20m vs 10×20）
CAD 与 Vault 属性不同步
→ 最终使得自动化、检索、BOM 生成等高级功能失效。

▸ 它如何工作？
当启用 Data Standard 后，在以下关键操作时，自动弹出一个标准化数据录入窗口（常称 Property Dialog）：

Vault Client 中：

新建/编辑 文件（对应 File.xaml）
新建/编辑 文件夹（对应 Folder.xaml）


Inventor / AutoCAD 中：

检入（Check In） 文件时
保存到 Vault 时



该窗口默认采用 左右双栏布局：

  
      
          区域
          内容
          控制方式
      
  
  
      
          左侧面板
          固定属性（Static Properties）由 XAML 手动定义的控件（如 <TextBox>、<ComboBox>）
          修改 File.xaml / Folder.xaml
      
      
          右侧面板
          动态属性 Grid（Dynamic Properties）自动列出该 Vault Category 下关联的所有 Attribute
          由 DynamicProperties.xml 控制显隐、顺序、别名
      
  


补充说明：除文件（File）与文件夹（Folder）外，以下对象也支持 Data Standard（较少用但存在）："><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Vault Data Standard (VDS)二次开发速查笔记","item":"http://localhost:1313/posts/vault-data-standard-vds%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E9%80%9F%E6%9F%A5%E7%AC%94%E8%AE%B0/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Vault Data Standard (VDS)二次开发速查笔记","name":"Vault Data Standard (VDS)二次开发速查笔记","description":"一、什么是 Autodesk Vault Data Standard（VDS）？ 常见误解纠正：\n名称 Data Standard 并非指“数据校验（Validation）”，而是 “数据标准化（Standardization）” —— 它的核心使命是：\n在用户输入源头，将自由、随意、不一致的数据，转化为结构化、规范、可被系统理解的属性值。\n▸ 它解决什么问题？ 在未启用 Data Standard 时，Vault 用户检入文件仅能填写极少数基础字段（如文件名、生命周期状态），大量业务属性（如 型号、流量、材质、明细写法）依赖后续手动补录，极易导致：\n属性缺失、错填、单位混乱（1500rpm vs 1500 RPM） 同类文件规格描述格式不一（Q=10m³/h, H=20m vs 10×20） CAD 与 Vault 属性不同步\n→ 最终使得自动化、检索、BOM 生成等高级功能失效。 ▸ 它如何工作？ 当启用 Data Standard 后，在以下关键操作时，自动弹出一个标准化数据录入窗口（常称 Property Dialog）：\nVault Client 中： 新建/编辑 文件（对应 File.xaml） 新建/编辑 文件夹（对应 Folder.xaml） Inventor / AutoCAD 中： 检入（Check In） 文件时 保存到 Vault 时 该窗口默认采用 左右双栏布局：\n区域 内容 控制方式 左侧面板 固定属性（Static Properties）由 XAML 手动定义的控件（如 \u0026lt;TextBox\u0026gt;、\u0026lt;ComboBox\u0026gt;） 修改 File.xaml / Folder.xaml 右侧面板 动态属性 Grid（Dynamic Properties）自动列出该 Vault Category 下关联的所有 Attribute 由 DynamicProperties.xml 控制显隐、顺序、别名 补充说明：除文件（File）与文件夹（Folder）外，以下对象也支持 Data Standard（较少用但存在）：\n","keywords":["Vault","VDS","DataStandard"],"articleBody":"一、什么是 Autodesk Vault Data Standard（VDS）？ 常见误解纠正：\n名称 Data Standard 并非指“数据校验（Validation）”，而是 “数据标准化（Standardization）” —— 它的核心使命是：\n在用户输入源头，将自由、随意、不一致的数据，转化为结构化、规范、可被系统理解的属性值。\n▸ 它解决什么问题？ 在未启用 Data Standard 时，Vault 用户检入文件仅能填写极少数基础字段（如文件名、生命周期状态），大量业务属性（如 型号、流量、材质、明细写法）依赖后续手动补录，极易导致：\n属性缺失、错填、单位混乱（1500rpm vs 1500 RPM） 同类文件规格描述格式不一（Q=10m³/h, H=20m vs 10×20） CAD 与 Vault 属性不同步\n→ 最终使得自动化、检索、BOM 生成等高级功能失效。 ▸ 它如何工作？ 当启用 Data Standard 后，在以下关键操作时，自动弹出一个标准化数据录入窗口（常称 Property Dialog）：\nVault Client 中： 新建/编辑 文件（对应 File.xaml） 新建/编辑 文件夹（对应 Folder.xaml） Inventor / AutoCAD 中： 检入（Check In） 文件时 保存到 Vault 时 该窗口默认采用 左右双栏布局：\n区域 内容 控制方式 左侧面板 固定属性（Static Properties）由 XAML 手动定义的控件（如 、） 修改 File.xaml / Folder.xaml 右侧面板 动态属性 Grid（Dynamic Properties）自动列出该 Vault Category 下关联的所有 Attribute 由 DynamicProperties.xml 控制显隐、顺序、别名 补充说明：除文件（File）与文件夹（Folder）外，以下对象也支持 Data Standard（较少用但存在）：\nJob（任务）：Job.xaml（用于自定义 Job Handler 参数录入） Change Order（变更单）：ChangeOrder.xaml（需 Vault Professional + Change Order 模块） BOM View（BOM 视图）：部分定制场景可用\n但 95% 的开发集中在 File / Folder / CAD 检入 三类场景。 配合 PowerShell 脚本与窗口生命周期钩子，Data Standard 可实现以下核心能力：\n自动填充初值（如根据文件名、分类或已有属性推导默认值） 动态联动计算（如选中“泵类” → 自动拼接 {流量}×{扬程}×{转速} 生成规格） 输入校验与拦截（如必填项检查、单位格式规范、范围值验证） UI 动态调整（如按角色/状态控制字段显隐、只读） 二、Data Standard 开发的本质：配置覆写而非代码编译 与传统 .NET 插件开发（需编译 DLL、注册 COM、重启服务）不同，Data Standard 的二次开发本质上是「配置层覆写」：\n不新增组件，只修改/新增特定 XML、XAML、PowerShell 文件； 不依赖构建工具，改完即部署（复制 *.Custom 目录到目标机器）； 不影响原生功能，升级 Vault 时原配置无损（Custom 目录独立存在）。 因此，在动手前，先理解其目录组织逻辑至关重要——它直接决定了：\n改哪个文件能影响哪个行为 如何打包交付 如何确保多环境一致性（开发 / 测试 / 生产环境结构完全对齐） ▸ DataStandard 目录结构 类型 路径 作用 是否可直接修改？ 原始配置 Vault\\, CAD\\ Autodesk 官方默认模板与脚本 禁止直接改（升级易覆盖） 自定义覆盖 Vault.Custom\\, CAD.Custom\\ 二开主战场：同名文件优先加载 推荐只改这里 其他文件 禁止直接改 ▸ *.Custom 内部结构详解（以 Vault.Custom 为例） Vault.Custom\\ ├── addinVault\\ ← PowerShell 脚本逻辑层（核心！） │ └── default.ps1 ← 全局钩子脚本（重点） | └── ... ├── Configurations\\ ← UI 与属性配置层 │ ├── File.xaml ← 文件属性页模板 │ ├── File.xml │ ├── Folder.xaml │ ├── VaultDynamicProperties.xml ← 动态属性 Grid 控制（关键！） │ └── ... └── MenuDefinitions.xml ← 右键/工具栏菜单定义（独立于 Configurations！） 三、核心开发点 1：*DynamicProperties.xml —— 控制右侧动态属性 Grid 这是最轻量的定制入口：仅通过声明式配置，即可统一属性显隐与顺序，为后续所有逻辑打下清晰的数据基础。\n▸ 作用 Vault 属性页分两栏： 左边：静态属性（硬编码在 XAML 中的 ） 右边：动态属性 Grid（自动列出 Vault 中定义的 Attribute） ▸ 控制逻辑 未在 *DynamicProperties.xml 中定义的 Vault 特性\n→ 按 Vault 中定义的原始顺序显示在最前面 已定义的 Vault 特性\n→ 按 *DynamicProperties.xml 中 的书写顺序显示在后面 ▸ 示例：屏蔽 Comment，调整 Material 位置 ","wordCount":"633","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-12-16T14:48:40+08:00","dateModified":"2025-12-16T14:48:40+08:00","author":{"@type":"Person","name":"Snailya"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/vault-data-standard-vds%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91%E9%80%9F%E6%9F%A5%E7%AC%94%E8%AE%B0/"},"publisher":{"@type":"Organization","name":"Snailya虾啵啵","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Snailya虾啵啵 (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Snailya虾啵啵</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/search/ title=搜索><span>搜索</span></a></li><li><a href=http://localhost:1313/categories/ title=分类><span>分类</span></a></li><li><a href=http://localhost:1313/tags/ title=标签><span>标签</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Vault Data Standard (VDS)二次开发速查笔记</h1><div class=post-meta><span title='2025-12-16 14:48:40 +0800 CST'>December 16, 2025</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;633 words&nbsp;·&nbsp;Snailya&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/Vault%20Data%20Standard%20%28VDS%29%e4%ba%8c%e6%ac%a1%e5%bc%80%e5%8f%91%e9%80%9f%e6%9f%a5%e7%ac%94%e8%ae%b0.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=一什么是-autodesk-vault-data-standardvds>一、什么是 Autodesk Vault Data Standard（VDS）？<a hidden class=anchor aria-hidden=true href=#一什么是-autodesk-vault-data-standardvds>#</a></h2><blockquote><p><strong>常见误解纠正</strong>：<br>名称 <em>Data Standard</em> 并非指“数据校验（Validation）”，而是 <strong>“数据标准化（Standardization）”</strong> —— 它的核心使命是：<br><strong>在用户输入源头，将自由、随意、不一致的数据，转化为结构化、规范、可被系统理解的属性值</strong>。</p></blockquote><h3 id=-它解决什么问题>▸ 它解决什么问题？<a hidden class=anchor aria-hidden=true href=#-它解决什么问题>#</a></h3><p>在未启用 Data Standard 时，Vault 用户检入文件仅能填写极少数基础字段（如文件名、生命周期状态），大量业务属性（如 <code>型号</code>、<code>流量</code>、<code>材质</code>、<code>明细写法</code>）依赖后续手动补录，极易导致：</p><ul><li>属性缺失、错填、单位混乱（<code>1500rpm</code> vs <code>1500 RPM</code>）</li><li>同类文件规格描述格式不一（<code>Q=10m³/h, H=20m</code> vs <code>10×20</code>）</li><li>CAD 与 Vault 属性不同步<br>→ 最终使得自动化、检索、BOM 生成等高级功能失效。</li></ul><h3 id=-它如何工作>▸ 它如何工作？<a hidden class=anchor aria-hidden=true href=#-它如何工作>#</a></h3><p>当启用 Data Standard 后，在以下关键操作时，<strong>自动弹出一个标准化数据录入窗口</strong>（常称 <em>Property Dialog</em>）：</p><ul><li>Vault Client 中：<ul><li>新建/编辑 <strong>文件</strong>（对应 <code>File.xaml</code>）</li><li>新建/编辑 <strong>文件夹</strong>（对应 <code>Folder.xaml</code>）</li></ul></li><li>Inventor / AutoCAD 中：<ul><li><strong>检入（Check In）</strong> 文件时</li><li><strong>保存到 Vault</strong> 时</li></ul></li></ul><p>该窗口默认采用 <strong>左右双栏布局</strong>：</p><table><thead><tr><th>区域</th><th>内容</th><th>控制方式</th></tr></thead><tbody><tr><td><strong>左侧面板</strong></td><td><strong>固定属性（Static Properties）</strong>由 XAML 手动定义的控件（如 <code>&lt;TextBox></code>、<code>&lt;ComboBox></code>）</td><td>修改 <code>File.xaml</code> / <code>Folder.xaml</code></td></tr><tr><td><strong>右侧面板</strong></td><td><strong>动态属性 Grid（Dynamic Properties）</strong>自动列出该 Vault Category 下关联的所有 Attribute</td><td>由 <code>DynamicProperties.xml</code> 控制显隐、顺序、别名</td></tr></tbody></table><blockquote><p><strong>补充说明</strong>：除文件（File）与文件夹（Folder）外，以下对象也支持 Data Standard（较少用但存在）：</p><ul><li><strong>Job（任务）</strong>：<code>Job.xaml</code>（用于自定义 Job Handler 参数录入）</li><li><strong>Change Order（变更单）</strong>：<code>ChangeOrder.xaml</code>（需 Vault Professional + Change Order 模块）</li><li><strong>BOM View（BOM 视图）</strong>：部分定制场景可用<br>但 95% 的开发集中在 <strong>File / Folder / CAD 检入</strong> 三类场景。</li></ul></blockquote><p>配合 PowerShell 脚本与窗口生命周期钩子，Data Standard 可实现以下核心能力：</p><ul><li>自动填充初值（如根据文件名、分类或已有属性推导默认值）</li><li>动态联动计算（如选中“泵类” → 自动拼接 {流量}×{扬程}×{转速} 生成规格）</li><li>输入校验与拦截（如必填项检查、单位格式规范、范围值验证）</li><li>UI 动态调整（如按角色/状态控制字段显隐、只读）</li></ul><h2 id=二data-standard-开发的本质配置覆写而非代码编译>二、Data Standard 开发的本质：配置覆写而非代码编译<a hidden class=anchor aria-hidden=true href=#二data-standard-开发的本质配置覆写而非代码编译>#</a></h2><p>与传统 .NET 插件开发（需编译 DLL、注册 COM、重启服务）不同，<strong>Data Standard 的二次开发本质上是「配置层覆写」</strong>：</p><ul><li>不新增组件，<strong>只修改/新增特定 XML、XAML、PowerShell 文件</strong>；</li><li>不依赖构建工具，<strong>改完即部署</strong>（复制 <code>*.Custom</code> 目录到目标机器）；</li><li>不影响原生功能，<strong>升级 Vault 时原配置无损</strong>（Custom 目录独立存在）。</li></ul><p>因此，在动手前，<strong>先理解其目录组织逻辑至关重要</strong>——它直接决定了：</p><ul><li>改哪个文件能影响哪个行为</li><li>如何打包交付</li><li>如何确保多环境一致性（开发 / 测试 / 生产环境结构完全对齐）</li></ul><h3 id=-datastandard-目录结构>▸ DataStandard 目录结构<a hidden class=anchor aria-hidden=true href=#-datastandard-目录结构>#</a></h3><table><thead><tr><th>类型</th><th>路径</th><th>作用</th><th>是否可直接修改？</th></tr></thead><tbody><tr><td><strong>原始配置</strong></td><td><code>Vault\</code>, <code>CAD\</code></td><td>Autodesk 官方默认模板与脚本</td><td><strong>禁止直接改</strong>（升级易覆盖）</td></tr><tr><td><strong>自定义覆盖</strong></td><td><code>Vault.Custom\</code>, <code>CAD.Custom\</code></td><td><strong>二开主战场</strong>：同名文件优先加载</td><td><strong>推荐只改这里</strong></td></tr><tr><td><strong>其他文件</strong></td><td></td><td></td><td><strong>禁止直接改</strong></td></tr></tbody></table><h3 id=-custom-内部结构详解以-vaultcustom-为例>▸ <code>*.Custom</code> 内部结构详解（以 <code>Vault.Custom</code> 为例）<a hidden class=anchor aria-hidden=true href=#-custom-内部结构详解以-vaultcustom-为例>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Vault.Custom\
</span></span><span class=line><span class=cl>├── addinVault\                     ← PowerShell 脚本逻辑层（核心！）
</span></span><span class=line><span class=cl>│   └── default.ps1             ← 全局钩子脚本（重点）
</span></span><span class=line><span class=cl>|   └── ...
</span></span><span class=line><span class=cl>├── Configurations\             ← UI 与属性配置层
</span></span><span class=line><span class=cl>│   ├── File.xaml               ← 文件属性页模板
</span></span><span class=line><span class=cl>│   ├── File.xml
</span></span><span class=line><span class=cl>│   ├── Folder.xaml
</span></span><span class=line><span class=cl>│   ├── VaultDynamicProperties.xml   ← 动态属性 Grid 控制（关键！）
</span></span><span class=line><span class=cl>│   └── ...
</span></span><span class=line><span class=cl>└── MenuDefinitions.xml         ← 右键/工具栏菜单定义（独立于 Configurations！）
</span></span></code></pre></div><h2 id=三核心开发点-1dynamicpropertiesxml--控制右侧动态属性-grid>三、核心开发点 1：<code>*DynamicProperties.xml</code> —— 控制右侧动态属性 Grid<a hidden class=anchor aria-hidden=true href=#三核心开发点-1dynamicpropertiesxml--控制右侧动态属性-grid>#</a></h2><blockquote><p>这是最轻量的定制入口：仅通过声明式配置，即可统一属性显隐与顺序，为后续所有逻辑打下清晰的数据基础。</p></blockquote><h3 id=-作用>▸ 作用<a hidden class=anchor aria-hidden=true href=#-作用>#</a></h3><ul><li>Vault 属性页分两栏：<ul><li>左边：<strong>静态属性</strong>（硬编码在 XAML 中的 <code>&lt;TextBox></code>）</li><li>右边：<strong>动态属性 Grid</strong>（自动列出 Vault 中定义的 Attribute）</li></ul></li></ul><h3 id=-控制逻辑>▸ 控制逻辑<a hidden class=anchor aria-hidden=true href=#-控制逻辑>#</a></h3><ul><li><strong>未在 <code>*DynamicProperties.xml</code> 中定义的 Vault 特性</strong><br>→ 按 Vault 中定义的<strong>原始顺序</strong>显示在<strong>最前面</strong></li><li><strong>已定义的 Vault 特性</strong><br>→ 按 <code>*DynamicProperties.xml</code> 中 <code>&lt;Property></code> 的<strong>书写顺序</strong>显示在<strong>后面</strong></li></ul><h3 id=-示例屏蔽-comment调整-material-位置>▸ 示例：屏蔽 <code>Comment</code>，调整 <code>Material</code> 位置<a hidden class=anchor aria-hidden=true href=#-示例屏蔽-comment调整-material-位置>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=c>&lt;!-- Vault.Custom\Configurations\VaultDynamicProperties.xml --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;DynamicProperties&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;DynamicPropertiesCategory</span> <span class=na>Category=</span><span class=s>&#34;工程&#34;</span> <span class=na>Type=</span><span class=s>&#34;FILE&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;DynamicProperty&gt;</span>设计人<span class=nt>&lt;/DynamicProperty&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;DynamicProperty&gt;</span>校对人<span class=nt>&lt;/DynamicProperty&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;DynamicProperty</span> <span class=na>Hidden=</span><span class=s>&#34;True&#34;</span><span class=nt>&gt;</span>关键词<span class=nt>&lt;/DynamicProperty&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/DynamicPropertiesCategory&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/DynamicProperties&gt;</span>
</span></span></code></pre></div><h2 id=四核心开发点-2xaml--静态属性定制>四、核心开发点 2：<code>*.xaml</code> —— 静态属性定制<a hidden class=anchor aria-hidden=true href=#四核心开发点-2xaml--静态属性定制>#</a></h2><p>通过覆写 <code>CustomVault\Configurations\</code> 下的 XAML 文件（如 <code>File.xaml</code>、<code>Folder.xaml</code>、<code>Job.xaml</code>），可自定义 Property Dialog 的左侧静态区域。</p><h3 id=-支持的绑定类型直接复用-vds-内建机制>▸ 支持的绑定类型（直接复用 VDS 内建机制）<a hidden class=anchor aria-hidden=true href=#-支持的绑定类型直接复用-vds-内建机制>#</a></h3><h4 id=1-绑定-vault-attribute读写>1. 绑定 Vault Attribute（读写）<a hidden class=anchor aria-hidden=true href=#1-绑定-vault-attribute读写>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;ComboBox</span> <span class=na>SelectedValue=</span><span class=s>&#34;{Binding Prop[_NumSchm].Value}&#34;</span> <span class=err>...</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;TextBox</span> <span class=na>Text=</span><span class=s>&#34;{Binding Prop[DETAIL_SPEC].Value}&#34;</span> <span class=err>...</span> <span class=nt>/&gt;</span>
</span></span></code></pre></div><ul><li><code>Prop[xxx].Value</code>：与 Vault 中定义的 Attribute name 严格一致（区分大小写、下划线）</li><li>支持 <code>.Text</code>（显示值）、<code>.Value</code>（存储值）分离（用于单位处理）</li></ul><h4 id=2-绑定-powershell-数据源>2. 绑定 PowerShell 数据源<a hidden class=anchor aria-hidden=true href=#2-绑定-powershell-数据源>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;ComboBox</span> <span class=na>ItemsSource=</span><span class=s>&#34;{Binding PsList[GetMaterials]}&#34;</span> <span class=err>...</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;CheckBox</span> <span class=na>IsChecked=</span><span class=s>&#34;{Binding PsValue[IsMFile]}&#34;</span> <span class=err>...</span> <span class=nt>/&gt;</span>
</span></span></code></pre></div><ul><li><code>PsList[FunctionName]</code> → 调用 <code>default.ps1</code> 中 <code>function FunctionName { ... }</code>，返回数组</li><li><code>PsValue[FunctionName]</code> → 调用同名函数，返回单值（如布尔、字符串）</li></ul><h4 id=3-绑定校验>3. 绑定校验<a hidden class=anchor aria-hidden=true href=#3-绑定校验>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;TextBox</span> <span class=na>Text=</span><span class=s>&#34;{WPF:ValidatedBinding Prop[PartNumber].Value}&#34;</span> <span class=err>...</span> <span class=nt>/&gt;</span>
</span></span></code></pre></div><h4 id=4-自定义转换器>4. 自定义转换器<a hidden class=anchor aria-hidden=true href=#4-自定义转换器>#</a></h4><p>除内建转换器外，支持通过自定义 .NET 程序集扩展转换逻辑：</p><ul><li>编写实现 <code>IValueConverter</code> 的类（如 <code>IncreaseByOneConverter</code>）</li><li>编译为 DLL（如 <code>MyConverters.dll</code>）</li><li>将 DLL 置于 <strong><code>CustomVault\addins\</code> 目录</strong>（与 <code>default.ps1</code> 同级，VDS 会自动加载该目录下所有 DLL）</li><li>在 XAML 中声明命名空间并注册为静态资源：</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;WPF:DSWindow</span> <span class=na>xmlns=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:x=</span><span class=s>&#34;http://schemas.microsoft.com/winfx/2006/xaml&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:my=</span><span class=s>&#34;clr-namespace:MyNamespace;assembly=MyConverters&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;Window.Resources&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;my:IncreaseByOneConverter</span> <span class=na>x:Key=</span><span class=s>&#34;IncreaseByOneConverter&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/Window.Resources&gt;</span>
</span></span></code></pre></div><p>使用示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;TextBox</span> <span class=na>Text=</span><span class=s>{Binding</span> <span class=err>...,</span> <span class=na>Converter=</span><span class=s>{StaticResource</span> <span class=err>MyConverter}}</span> <span class=nt>/&gt;</span>
</span></span></code></pre></div><h2 id=五核心开发点-3defaultps1--默认值与生命周期钩子>五、核心开发点 3：<code>default.ps1</code> —— 默认值与生命周期钩子<a hidden class=anchor aria-hidden=true href=#五核心开发点-3defaultps1--默认值与生命周期钩子>#</a></h2><blockquote><p>当静态布局不足以表达业务规则时，需引入动态逻辑：通过 PowerShell 钩子，在窗口生命周期关键节点注入计算、回退或校验能力——这是从“能填”迈向“填对”的关键跃升。</p></blockquote><p>这是你提到的“初始化窗口时设初值”的主入口。其核心是 <strong>注册事件处理器</strong>，常用两个阶段：</p><table><thead><tr><th>阶段</th><th>函数</th><th>时机</th><th>典型用途</th></tr></thead><tbody><tr><td><code>InitializeWindow</code></td><td><code>function InitializeWindow { ... }</code></td><td><strong>窗口打开后、数据绑定后</strong></td><td>读取现有值、计算默认值、设置控件状态</td></tr><tr><td><code>WindowClosing</code></td><td><code>function WindowClosing { ... }</code></td><td><strong>用户点击“确定/取消”后、窗口关闭前</strong></td><td>清理资源、记录日志、<strong>阻止关闭</strong>（返回 <code>$false</code>）</td></tr></tbody></table><h3 id=-示例自动填充-明细写法detail_spec>▸ 示例：自动填充 <code>明细写法</code>（DETAIL_SPEC）<a hidden class=anchor aria-hidden=true href=#-示例自动填充-明细写法detail_spec>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># CustomVault\addins\default.ps1</span>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>InitializeWindow</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span><span class=p>(</span><span class=nv>$window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># 获取属性对象（只读/可写）</span>
</span></span><span class=line><span class=cl>    <span class=nv>$prop</span> <span class=p>=</span> <span class=nv>$window</span><span class=p>.</span><span class=py>DataContext</span><span class=p>.</span><span class=py>Property</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># 若 DETAIL_SPEC 为空，回退到 DETAIL</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>([</span><span class=no>string</span><span class=p>]::</span><span class=n>IsNullOrWhiteSpace</span><span class=p>(</span><span class=nv>$prop</span><span class=p>[</span><span class=s2>&#34;DETAIL_SPEC&#34;</span><span class=p>].</span><span class=n>Value</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$prop</span><span class=p>[</span><span class=s2>&#34;DETAIL_SPEC&#34;</span><span class=p>].</span><span class=py>Value</span> <span class=p>=</span> <span class=nv>$prop</span><span class=p>[</span><span class=s2>&#34;DETAIL&#34;</span><span class=p>].</span><span class=py>Value</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># 示例：按文件名设 SyncToEPlan（你提过的逻辑）</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$window</span><span class=p>.</span><span class=py>DataContext</span><span class=p>.</span><span class=py>File</span> <span class=o>-and</span> <span class=nv>$window</span><span class=p>.</span><span class=py>DataContext</span><span class=p>.</span><span class=py>File</span><span class=p>.</span><span class=py>Name</span> <span class=o>-match</span> <span class=s2>&#34;^M&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$prop</span><span class=p>[</span><span class=s2>&#34;SyncToEPlan&#34;</span><span class=p>].</span><span class=py>Value</span> <span class=p>=</span> <span class=s2>&#34;Yes&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>WindowClosing</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span><span class=p>(</span><span class=nv>$window</span><span class=p>,</span> <span class=nv>$dialogResult</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># 若点击“确定”但规格未填写，阻止提交</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$dialogResult</span> <span class=o>-eq</span> <span class=s2>&#34;OK&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$prop</span> <span class=p>=</span> <span class=nv>$window</span><span class=p>.</span><span class=py>DataContext</span><span class=p>.</span><span class=py>Property</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>([</span><span class=no>string</span><span class=p>]::</span><span class=n>IsNullOrWhiteSpace</span><span class=p>(</span><span class=nv>$prop</span><span class=p>[</span><span class=s2>&#34;DETAIL_SPEC&#34;</span><span class=p>].</span><span class=n>Value</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=no>System.Windows.Forms.MessageBox</span><span class=p>]::</span><span class=n>Show</span><span class=p>(</span><span class=s2>&#34;请填写明细规格！&#34;</span><span class=p>,</span> <span class=s2>&#34;校验失败&#34;</span><span class=p>,</span> <span class=s2>&#34;OK&#34;</span><span class=p>,</span> <span class=s2>&#34;Error&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=vm>$false</span>  <span class=c># 阻止窗口关闭 → 即阻止检入</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=vm>$true</span>  <span class=c># 允许关闭</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>补充知识点：</p><ul><li><code>PreSave</code> / <code>PostSave</code> 是 <strong>JobHandler 或 Vault API</strong> 的钩子，<strong>不是 VDS 的</strong></li><li>VDS 中只有 <code>InitializeWindow</code> / <code>WindowClosing</code> 是<strong>窗口级</strong>生命周期</li><li><code>$window.DataContext</code> 包含：<code>.File</code>, <code>.Folder</code>, <code>.Property</code>, <code>.Vault</code>, <code>.User</code> 等上下文</li></ul><h2 id=六核心开发点-4menudefinitionsxml--给-vault-client-加按钮>六、核心开发点 4：<code>MenuDefinitions.xml</code> —— 给 Vault Client 加按钮<a hidden class=anchor aria-hidden=true href=#六核心开发点-4menudefinitionsxml--给-vault-client-加按钮>#</a></h2><blockquote><p>前三个层级聚焦<strong>单对象的标准化输入</strong>；而自定义菜单将能力延伸至<strong>多对象批量操作与外部系统集成</strong>，是脱离 Property Dialog、走向自动化流水线的桥梁。</p></blockquote><h3 id=-位置与结构>▸ 位置与结构<a hidden class=anchor aria-hidden=true href=#-位置与结构>#</a></h3><ul><li><p><strong>路径</strong>：<code>CustomVault\MenuDefinitions.xml</code>（不在 Configurations 内！）</p></li><li><p><strong>结构</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;MenuDefinitions&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;MenuItems&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;MenuItem</span> <span class=na>id=</span><span class=s>&#34;MyExportButton&#34;</span> <span class=na>label=</span><span class=s>&#34;导出规格&#34;</span> <span class=err>...</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/MenuItems&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;CommandSites&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 定义按钮出现在哪些上下文 --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;CommandSite</span> <span class=na>location=</span><span class=s>&#34;FileContext&#34;</span><span class=nt>&gt;</span>        <span class=c>&lt;!-- 文件右键 --&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;MenuItemRef</span> <span class=na>id=</span><span class=s>&#34;MyExportButton&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/CommandSite&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;CommandSite</span> <span class=na>location=</span><span class=s>&#34;FolderContext&#34;</span><span class=nt>&gt;</span>      <span class=c>&lt;!-- 文件夹右键 --&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;MenuItemRef</span> <span class=na>id=</span><span class=s>&#34;MyExportButton&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/CommandSite&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;CommandSite</span> <span class=na>location=</span><span class=s>&#34;ExplorerToolbar&#34;</span><span class=nt>&gt;</span>    <span class=c>&lt;!-- 主工具栏 --&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;MenuItemRef</span> <span class=na>id=</span><span class=s>&#34;MyExportButton&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/CommandSite&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/CommandSites&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/MenuDefinitions&gt;</span>
</span></span></code></pre></div></li></ul><h3 id=-常用-location-对应关系附图建议位置>▸ 常用 <code>location</code> 对应关系（附图建议位置）<a hidden class=anchor aria-hidden=true href=#-常用-location-对应关系附图建议位置>#</a></h3><table><thead><tr><th><code>location</code></th><th>Vault 中位置</th><th>截图建议标注</th></tr></thead><tbody><tr><td><code>FileContext</code></td><td>文件右键菜单</td><td>右键任意文件 → 弹出菜单底部</td></tr><tr><td><code>FolderContext</code></td><td>文件夹右键菜单</td><td>右键文件夹 → 弹出菜单</td></tr><tr><td><code>ExplorerToolbar</code></td><td>主窗口顶部工具栏</td><td>左上角“新建”“检入”旁</td></tr><tr><td><code>PropertyPage</code></td><td>属性页底部按钮区</td><td>文件属性页 → “确定/取消”旁</td></tr><tr><td><code>JobQueueContext</code></td><td>任务队列右键</td><td>Job Processor 窗口右键</td></tr></tbody></table><blockquote><p><strong>实现点击逻辑</strong>：<br>需配合 <code>addins\default.ps1</code> 中定义同名函数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>MyExportButton_Click</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span><span class=p>(</span><span class=nv>$selection</span><span class=p>)</span>  <span class=c># 当前选中项数组</span>
</span></span><span class=line><span class=cl>    <span class=c># 你的导出逻辑</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></blockquote></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=http://localhost:1313/posts/%E5%BD%93%E4%B8%8D%E5%80%BC%E5%BE%97%E6%88%90%E4%B8%BA%E6%8A%A4%E5%9F%8E%E6%B2%B3/><span class=title>Next »</span><br><span>当“不值得”成为护城河————观察AI对于行业的渗透</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=Snailya/snailya.github.io data-repo-id=R_kgDOLDeIag data-category=Announcements data-category-id=DIC_kwDOLDeIas4CcWGj data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Snailya虾啵啵</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
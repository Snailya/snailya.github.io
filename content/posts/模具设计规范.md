+++
title = '模具设计规范'
date = 2025-04-16T11:00:55+08:00
draft = true
+++

每个主控形状（Master对象）下仅包括一个主形状（Shape对象）。主形状是一个Group类型的对象，主形状中不能定义任何几何内容（Geometry），而是存储描述该模具所需的用户定义数据。需要在绘图页中显示的文本、几何形状都作为主形状下的子形状（Shape对象），并使用主形状中定义的数据触发其内容的变化。

![image.png](https://s2.loli.net/2025/04/16/FmvZzbOf4sUNxhu.png)

这么做的理由时，用户一旦将主控形状（Master对象）拖入绘图页后，任何针对该主控形状的实例（Shape对象）的操作，都仅更新主形状实例的数据。这样，当管理员更新该对象的几何表达时，程序只需要替换子形状的内容，这样用户操作引发的数据变化不会丢失。当使用OpenXML更新文档模具中的主控形状时，将page页中的形状实例数据中的子形状替换为MasterContent中的子形状，然后再标记`new XProcessingInstruction("NewValue", "V")`，迫使该子形状数据在下次打开时重新计算，保证绘图页中子形状得到刷新。

除此以外，为了保证子形状中的数据被正确计算，其引用的主形状中的单元格值不能是Guard值，否则系统会认为该单元格值不需要被更新。

![image.png](https://s2.loli.net/2025/04/16/GP2fuACdD1Sc65H.png)
